var sentence_parser=function(a){"use strict";var b=function(a){var b=a.match(/\[\[/)||[],c=a.match(/\]\]/)||[];return b.length>c.length},c=a.split(/(\S.+?[.\?])(?=\s+|$|")/g),d=[],e=["jr","mr","mrs","ms","dr","prof","sr","sen","corp","calif","rep","gov","atty","supt","det","rev","col","gen","lt","cmdr","adm","capt","sgt","cpl","maj","dept","univ","assn","bros","inc","ltd","co","corp","arc","al","ave","blvd","cl","ct","cres","exp","rd","st","dist","mt","ft","fy","hwy","la","pd","pl","plz","tce","Ala","Ariz","Ark","Cal","Calif","Col","Colo","Conn","Del","Fed","Fla","Ga","Ida","Id","Ill","Ind","Ia","Kan","Kans","Ken","Ky","La","Me","Md","Mass","Mich","Minn","Miss","Mo","Mont","Neb","Nebr","Nev","Mex","Okla","Ok","Ore","Penna","Penn","Pa","Dak","Tenn","Tex","Ut","Vt","Va","Wash","Wis","Wisc","Wy","Wyo","USAFA","Alta","Ont","QuÔøΩ","Sask","Yuk","jan","feb","mar","apr","jun","jul","aug","sep","oct","nov","dec","sept","vs","etc","esp","llb","md","bl","phd","ma","ba","miss","misses","mister","sir","esq","mstr","lit","fl","ex","eg","sep","sept",".."],f=new RegExp("(^| )("+e.join("|")+")[.] ?$","i");for(var g in c)c[g]&&(c[g]=c[g].replace(/^\s+|\s+$/g,""),c[g].match(f)||c[g].match(/[ |\.][A-Z]\.?$/)||b(c[g])?c[parseInt(g)+1]=c[g]+" "+c[parseInt(g)+1]:(d.push(c[g]),c[g]=""));var h=[];for(g in d)d[g]=d[g].replace(/^\s+|\s+$/g,""),d[g]&&h.push(d[g]);return 0==h.length?[a]:h};"undefined"!=typeof module&&module.exports&&(module.exports=sentence_parser);var wtf_wikipedia=function(){"use strict";function a(a,b,c){for(var d=[],e=[],f=c.split(""),g=0,h=0;h<f.length;h++){if(f[h]==a&&f[h+1]&&f[h+1]==a&&(g+=1),g>=0&&e.push(f[h]),0>=g&&e.length>0){var i=e.filter(function(b){return b==a}),j=e.filter(function(a){return a==b});i.length>j.length&&e.push(b),d.push(e.join("")),e=[]}f[h]==b&&f[h+1]&&f[h+1]==b&&(g-=1,0>g&&(g=0))}return d}function b(a){var b=[],c=a.match(/\[\[(.{2,80}?)\]\](\w{0,10})/g);return c&&c.forEach(function(a){var c,d;if(a.match(/\|/)?(a=a.replace(/\[\[(.{2,80}?)\]\](\w{0,10})/g,"$1$2"),c=a.replace(/(.{2,60})\|.{0,200}/,"$1"),d=a.replace(/.{2,60}?\|/,""),!d&&c.match(/\|$/)&&(c=c.replace(/\|$/,""),d=c)):c=a.replace(/\[\[(.{2,60}?)\]\](\w{0,10})/g,"$1"),!c.match(/^:?(category|image|file|media|special|wp|wikipedia|help|user|mediawiki|portal|talk|template|book|draft|module|topic|wiktionary|wikisource):/i)&&!c.match(/^#/i)){c=c.replace(/#[^ ]{1,100}/,""),c=m.capitalise(c);var e={page:c,src:d};b.push(e)}}),b=b.filter(m.onlyUnique),0==b.length?void 0:b}function c(a){var b=[],c=a.match(/\[\[:?category:(.{2,60}?)\]\](\w{0,10})/gi);return c&&c.forEach(function(a){a=a.replace(/^\[\[:?category:/i,""),a=a.replace(/\|?[ \*]?\]\]$/i,""),a&&!a.match(/[\[\]]/)&&b.push(a)}),b}function d(a){var b=/\[\[:?Category:[^\[\]]{2,80}\]\]/g;return a=a.replace(b,""),a=a.replace(/\[\[:?([^|]{2,80}?)\]\](\w{0,5})/g,"$1$2"),a=a.replace(/\[\[:?(.{2,80}?)\|([^\]]+?)\]\](\w{0,5})/g,"$2$3"),a=a.replace(/\[(https?|news|ftp|mailto|gopher|irc):\/\/[^ ]{4,1500}\]/g,"")}function e(a){return a=a.match(/(file|image):.*?[\|\]]/i)||[""],a=a[0].replace(/\|$/,"")}function f(a){var b={};return a&&(a=a.replace(/\{\{Collapsible list[^\}]{10,1000}\}\}/g,""),a.replace(/\r/g,"").split(/\n/).forEach(function(a){if(a.match(/^\|/)){var c=a.match(/^\| ?([^ ]{1,200}) /)||{};c=m.trim_whitespace(c[1]||"");var d=a.match(/=(.{1,500})$/)||[];d=m.trim_whitespace(d[1]||""),c&&d&&(b[c]=h(d),b[c].text.match(/^[0-9,]*$/)&&(b[c].text=b[c].text.replace(/,/g),b[c].text=parseInt(b[c].text)))}})),b}function g(a){return a=a.replace(/<!--[^>]{0,2000}-->/g,""),a=a.replace(/__(NOTOC|NOEDITSECTION|FORCETOC|TOC)__/gi,""),a=a.replace(/~~{1,3}/,""),a=a.replace(/--{1,3}/,""),a=a.replace(/&nbsp;/g," "),a=a.replace(/\[\[([a-z][a-z]|simple|war|ceb|min):.{2,60}\]\]/i,""),a=a.replace(/''{0,3}([^']{0,200})''{0,3}/g,"$1"),a=k(a),a=a.replace(/\{\|[\s\S]{1,8000}?\|\}/g,"")}function h(a){return{text:i(a),links:b(a)}}function i(a){return a=d(a),a.match(/^(thumb|right|left)\|/i)?void 0:(a=a.replace(/\([^a-z]{0,8}\)/,""),a=m.trim_whitespace(a))}function j(a){return a.match(/#redirect \[\[(.{2,60}?)\]\]/i)[1]}function k(a){return a=a.replace(/<ref>[\s\S]{0,500}?<\/ref>/gi," "),a=a.replace(/<ref [^>]{0,200}?\/>/gi," "),a=a.replace(/<ref [^>]{0,200}?>[\s\S]{0,500}?<\/ref>/gi," "),a=a.replace(/<(table|code|dl|hiero|math|score|data) ?[^>]{0,200}?>[\s\S]{0,500}<\/(table|code|dl|hiero|math|score|data)>/gi," "),a=a.replace(/< ?(ref|span|div|table|data) [a-z0-9=" ]{2,20}\/ ?>/g," "),a=a.replace(/<[ \/]?(p|sub|sup|span|nowiki|div|table|br|tr|td|th|pre|pre2|hr)[ \/]?>/g," "),a=a.replace(/<[ \/]?(abbr|bdi|bdo|blockquote|cite|del|dfn|em|i|ins|kbd|mark|q|s)[ \/]?>/g," "),a=a.replace(/<[ \/]?h[0-9][ \/]?>/g," "),a=a.replace(/<[ \/]?[a-z0-9]{1,8}[ \/]?>/g," ")}if("undefined"!=typeof module&&module.exports)var l=require("./sentence_parser");var m={capitalise:function(a){return a&&"string"==typeof a?a.charAt(0).toUpperCase()+a.slice(1):void 0},onlyUnique:function(a,b,c){return c.indexOf(a)===b},trim_whitespace:function(a){return a&&"string"==typeof a?(a=a.replace(/^\s\s*/,""),a=a.replace(/\s\s*$/,""),a=a.replace(/  /," "),a=a.replace(/\s, /,", ")):void 0}},n=function(a){a=a.replace(/\{\{URL\|([^ ]{4,100}?)\}\}/gi,"$1"),a=a.replace(/\{\{convert\|([0-9]*?)\|([^\|]*).*?\}\}/gi,"$1 $2");var b=new Date;a=a.replace(/\{\{(CURRENT|LOCAL)DAY(2)?\}\}/gi,b.getDate());var c=["January","February","March","April","May","June","July","August","September","October","November","December"];a=a.replace(/\{\{(CURRENT|LOCAL)MONTH(NAME|ABBREV)?\}\}/gi,c[b.getMonth()]),a=a.replace(/\{\{(CURRENT|LOCAL)YEAR\}\}/gi,b.getFullYear());var d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return a=a.replace(/\{\{(CURRENT|LOCAL)DAYNAME\}\}/gi,d[b.getDay()]),a=a.replace(/\{\{(lc|uc|formatnum):(.*?)\}\}/gi,"$2"),a=a.replace(/\{\{pull quote\|([\s\S]*?)(\|[\s\S]*?)?\}\}/gi,"$1")},o=function(b){var d="",i=[];if(b.match(/^#redirect \[\[.{2,60}?\]\]/i))return{redirect:j(b)};b=n(b),b=g(b);var k=a("{","}",b);k.forEach(function(a){a.match(/\{\{infobox /i)&&!d&&(d=f(a)),a.match(/\{\{(cite|infobox|sister|geographic|navboxes|listen)[ \|:\n]/i)&&(b=b.replace(a,""))}),k=a("[","]",b),k.forEach(function(a){a.match(/\[\[(file|image)/i)&&(i.push(e(a)),b=b.replace(a,""))}),b=b.replace(/\{\{.*?\}\}/g,"");var m=c(b),o=b.replace(/\r/g,"").split(/\n/),p={},q="Intro";if(o.forEach(function(a){l(a).forEach(function(a){if(q&&!a.match(/^[\*#:;\|]/)&&a.match(/[a-z0-9]/i)){if(a.match(/^={1,5}[^=]{1,200}={1,5}$/))return q=a.match(/^={1,5}([^=]{2,200}?)={1,5}$/)[1]||"",void(q.match(/^(references|see also|external links|further reading)$/i)&&(q=null));a=h(a),a&&a.text&&(p[q]||(p[q]=[]),p[q].push(a))}})}),d.image&&d.image.text){var r=d.image.text||"";r.match(/^(image|file)/i)||(r="File:"+r),i.push(r)}return{text:p,data:{categories:m,images:i},infobox:d}};return"undefined"!=typeof module&&module.exports&&(module.exports=o),o}();